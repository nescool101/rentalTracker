import{K as C,j as e,C as z,P as k,a as M,m as p,b as o,z as u,G as P,i as E,Y as w,Z as A,e as q,S as B,k as h,v as T,B as $,n as L}from"./mantine-vendor-Bripv_3X.js";import{r as l}from"./react-vendor-Cmr1RT9l.js";import{a as g}from"./utils-vendor-tZ1hTSV2.js";import{c as v,I as R,g as x,l as G}from"./index-BGAR1JXy.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var U=v("outline","copy-check","IconCopyCheck",[["path",{d:"M7 9.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-1"}],["path",{d:"M4.012 16.737a2 2 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-2"}],["path",{d:"M11 14l2 2l4 -4",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var V=v("outline","copy","IconCopy",[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]]);const _="";function N(){const[j,d]=l.useState(!1),[m,n]=l.useState(""),[I,b]=l.useState(!1),[c,S]=l.useState([]),i=C({initialValues:{email:"",name:"",additionalMessage:""},validate:{email:a=>/^\S+@\S+$/.test(a)?null:"Email inválido",name:a=>a.length<2?"El nombre es obligatorio":null}}),f=()=>Math.floor(1e7+Math.random()*9e7).toString(),y=async a=>{d(!0),n("");const t=f(),r=`${_}/api/invitations/manager`;console.log(`Sending invitation request to: ${r}`,a);try{const s=await g.post(r,{email:a.email,name:a.name,message:a.additionalMessage,tempPassword:t,status:"newuser"},{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});s.status===201||s.status===200?(L.show({title:"Invitación enviada",message:`Se ha enviado una invitación a ${a.email}`,color:"green",icon:e.jsx(x,{size:16})}),S([...c,{email:a.email,tempPassword:t}]),i.reset(),b(!0)):n("Hubo un problema al enviar la invitación")}catch(s){console.error("Error sending invitation:",s),g.isAxiosError(s)&&s.response?n(s.response.data.error||"Error en el servidor. Intente de nuevo más tarde."):n("Error de conexión. Verifique su conexión a internet e intente de nuevo.")}finally{d(!1)}};return e.jsx(z,{size:"md",my:40,children:e.jsxs(k,{radius:"md",p:"xl",withBorder:!0,children:[e.jsx(M,{order:2,ta:"center",mb:"lg",children:"Invitar Administradores de Propiedades"}),m&&e.jsx(p,{icon:e.jsx(R,{size:16}),title:"Error",color:"red",mb:"md",children:m}),I&&c.length>0&&e.jsxs(p,{icon:e.jsx(x,{size:16}),title:"Invitaciones enviadas",color:"green",mb:"md",children:[e.jsx(o,{mb:"sm",children:"Se han enviado invitaciones a los siguientes usuarios con sus contraseñas temporales:"}),e.jsx(u,{children:c.map((a,t)=>e.jsx(u.Item,{children:e.jsxs(P,{children:[e.jsx(o,{children:a.email}),e.jsx(o,{children:"Contraseña temporal: "}),e.jsx(E,{children:a.tempPassword}),e.jsx(w,{value:a.tempPassword,timeout:2e3,children:({copied:r,copy:s})=>e.jsx(A,{label:r?"Copiado":"Copiar",position:"right",children:e.jsx(q,{color:r?"teal":"gray",onClick:s,children:r?e.jsx(U,{size:"1rem"}):e.jsx(V,{size:"1rem"})})})})]})},t))}),e.jsx(o,{mt:"md",size:"sm",color:"dimmed",children:"Asegúrese de guardar o compartir estas contraseñas de forma segura. Los usuarios deberán cambiarlas al iniciar sesión por primera vez."})]}),e.jsx(o,{color:"dimmed",size:"sm",mb:"lg",children:"Envíe invitaciones por correo electrónico a nuevos administradores de propiedades para que se registren en el sistema. Se generará una contraseña temporal de 8 dígitos que el administrador deberá utilizar para su primer inicio de sesión."}),e.jsx("form",{onSubmit:i.onSubmit(y),children:e.jsxs(B,{gap:"md",children:[e.jsx(h,{label:"Nombre del administrador",placeholder:"Juan Pérez",required:!0,...i.getInputProps("name")}),e.jsx(h,{label:"Correo electrónico",placeholder:"correo@ejemplo.com",required:!0,...i.getInputProps("email")}),e.jsx(T,{label:"Mensaje adicional (opcional)",placeholder:"Bienvenido a nuestra aplicación, use las credenciales que se le enviarán por separado para acceder al sistema.",minRows:3,...i.getInputProps("additionalMessage")}),e.jsx($,{type:"submit",mt:"md",loading:j,leftSection:e.jsx(G,{size:16}),children:"Enviar Invitación"})]})})]})})}export{N as default};
