import{j as e,g as x,a as i,P as j,b as r,i as a,G as u,B as n}from"./mantine-vendor-D4AgWXPI.js";import{u as b,a as d}from"./index-cX4OG7Q0.js";import{u as A}from"./react-vendor-Q26-omST.js";import"./utils-vendor-CNi8B-Rx.js";const p=()=>{const{user:s,isAuthenticated:l,logout:m}=b(),t=A(),h=()=>{fetch("/api/persons",{headers:{Authorization:`Bearer ${d.getToken()}`}}).then(o=>{if(alert(`API Response status: ${o.status}`),!o.ok)throw new Error(`API returned ${o.status}`);return o.json()}).then(o=>{console.log("API data:",o),alert("API call successful! Check console for data.")}).catch(o=>{console.error("API call failed:",o),alert(`API call failed: ${o.message}`)})},c=()=>{d.refreshAdminToken()?(alert("Admin token refreshed. Reloading page..."),window.location.reload()):alert("Failed to refresh admin token.")};return e.jsxs(x,{p:"xl",maw:600,mx:"auto",my:"xl",children:[e.jsx(i,{order:2,mb:"md",children:"Authentication Debug"}),e.jsxs(j,{p:"md",withBorder:!0,mb:"lg",children:[e.jsx(i,{order:3,mb:"sm",children:"Auth Status"}),e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"Is Authenticated:"})," ",l?"Yes":"No"]}),e.jsx(i,{order:3,mt:"md",mb:"sm",children:"User Info"}),s?e.jsxs(e.Fragment,{children:[e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"User ID:"})," ",s.id]}),e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"Email:"})," ",s.email]}),e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"Role:"})," ",s.role]}),e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"Is Admin:"})," ",s.role==="admin"?"Yes":"No"]}),e.jsxs(r,{mb:"xs",children:[e.jsx("b",{children:"Person ID:"})," ",s.person_id||"None"]}),e.jsxs(r,{mb:"md",children:[e.jsx("b",{children:"Token Available:"})," ",d.getToken()?"Yes":"No"]}),e.jsx(i,{order:4,mt:"md",mb:"sm",children:"Token"}),e.jsx(a,{block:!0,mb:"md",children:d.getToken()||"No token"}),e.jsx(i,{order:4,mt:"md",mb:"sm",children:"Full User Object"}),e.jsx(a,{block:!0,mb:"md",children:JSON.stringify(s,null,2)})]}):e.jsx(r,{c:"dimmed",children:"No user logged in"})]}),e.jsxs(u,{children:[e.jsx(n,{onClick:h,color:"blue",children:"Test API Access"}),l&&e.jsx(n,{onClick:m,color:"red",children:"Logout"}),e.jsx(n,{onClick:()=>t("/login"),variant:"outline",children:"Go to Login"}),l&&(s==null?void 0:s.role)==="admin"&&e.jsx(n,{onClick:()=>t("/dashboard"),color:"green",children:"Go to Admin Dashboard"}),l&&(s==null?void 0:s.role)==="admin"&&e.jsx(n,{onClick:c,color:"yellow",children:"Force Refresh Admin Token"}),!l||(s==null?void 0:s.role)!=="admin"?e.jsx(n,{onClick:c,color:"orange",children:"Force Admin Access"}):null]})]})};export{p as default};
