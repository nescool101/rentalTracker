import{K as N,j as r,C as v,P as E,S as n,a as I,b as y,B as c,m as R,X as l,k as t,t as S,G as p,l as P,x as u,s as w,w as C,v as V,g as O,D as U,W as G,n as J}from"./mantine-vendor-Bripv_3X.js";import{r as m,u as M,L as $}from"./react-vendor-Cmr1RT9l.js";import{a as F}from"./utils-vendor-tZ1hTSV2.js";import{u as H,g as q,I as Y}from"./index-BGAR1JXy.js";const K="",k=[{value:"water",label:"Agua"},{value:"electricity",label:"Electricidad"},{value:"gas",label:"Gas"},{value:"internet",label:"Internet"},{value:"cable",label:"Cable/TV"},{value:"trash",label:"Basura"},{value:"sewer",label:"Alcantarillado"},{value:"landscaping",label:"Jardinería"},{value:"hoa",label:"Cuota HOA"},{value:"pool",label:"Mantenimiento de piscina"}],W=[{value:"apartment",label:"Apartamento"},{value:"house",label:"Casa"},{value:"condo",label:"Condominio"},{value:"townhouse",label:"Casa adosada"},{value:"studio",label:"Estudio"},{value:"other",label:"Otro"}],X=[{value:"checking",label:"Cuenta corriente"},{value:"savings",label:"Cuenta de ahorros"}];function ae(){const[i,h]=m.useState(0),[g,x]=m.useState(!1),[j,s]=m.useState(""),[A,z]=m.useState(!1),{user:_}=H(),T=M(),f=e=>{(b(i)||e<i)&&h(e)},a=N({initialValues:{full_name:"",phone:"",nit:"",email:"",password:"",confirm_password:"",property_address:"",property_apt_number:"",property_city:"",property_state:"",property_zip_code:"",property_type:"",bank_name:"",account_type:"",account_number:"",account_holder:"",monthly_rent:0,security_deposit:0,utilities_included:[],tenant_responsible_for:[],late_fee:0,due_day:1,start_date:new Date,end_date:new Date(new Date().setFullYear(new Date().getFullYear()+1)),payment_terms:""},validate:{full_name:e=>e?null:"El nombre es obligatorio",phone:e=>e?null:"El teléfono es obligatorio",email:e=>/^\S+@\S+$/.test(e)?null:"Email inválido",password:e=>e.length<8?"La contraseña debe tener al menos 8 caracteres":null,confirm_password:(e,d)=>e!==d.password?"Las contraseñas no coinciden":null,property_address:e=>e?null:"La dirección es obligatoria",property_city:e=>e?null:"La ciudad es obligatoria",property_state:e=>e?null:"El estado/provincia es obligatorio",property_type:e=>e?null:"El tipo de propiedad es obligatorio",bank_name:e=>e?null:"El nombre del banco es obligatorio",account_type:e=>e?null:"El tipo de cuenta es obligatorio",account_number:e=>e?null:"El número de cuenta es obligatorio",account_holder:e=>e?null:"El titular de la cuenta es obligatorio",monthly_rent:e=>e<=0?"La renta mensual debe ser mayor que cero":null,security_deposit:e=>e<0?"El depósito de seguridad no puede ser negativo":null,due_day:e=>e<1||e>31?"El día de vencimiento debe estar entre 1 y 31":null}}),b=e=>{switch(e){case 0:return!a.validateField("full_name").hasError&&!a.validateField("phone").hasError&&!a.validateField("email").hasError&&!a.validateField("password").hasError&&!a.validateField("confirm_password").hasError;case 1:return!a.validateField("property_address").hasError&&!a.validateField("property_city").hasError&&!a.validateField("property_state").hasError&&!a.validateField("property_type").hasError;case 2:return!a.validateField("bank_name").hasError&&!a.validateField("account_type").hasError&&!a.validateField("account_number").hasError&&!a.validateField("account_holder").hasError;case 3:return!a.validateField("monthly_rent").hasError&&!a.validateField("security_deposit").hasError&&!a.validateField("due_day").hasError;default:return!0}},D=()=>{b(i)&&i<4&&h(e=>e+1)},L=()=>{h(e=>e>0?e-1:e)},B=async e=>{for(let o=0;o<4;o++)if(!b(o)){f(o);return}if(!_||!_.token){s("No hay una sesión activa. Por favor inicie sesión nuevamente."),setTimeout(()=>T("/login"),2e3);return}x(!0),s("");const d={full_name:e.full_name,phone:e.phone,nit:e.nit,email:e.email,password:e.password,property_address:e.property_address,property_apt_number:e.property_apt_number,property_city:e.property_city,property_state:e.property_state,property_zip_code:e.property_zip_code,property_type:e.property_type,bank_name:e.bank_name,account_type:e.account_type,account_number:e.account_number,account_holder:e.account_holder,monthly_rent:e.monthly_rent,security_deposit:e.security_deposit,utilities_included:e.utilities_included,tenant_responsible_for:e.tenant_responsible_for,late_fee:e.late_fee,due_day:e.due_day,start_date:e.start_date,end_date:e.end_date,payment_terms:e.payment_terms};try{(await F.post(`${K}/api/register/manager`,d,{headers:{Authorization:`Bearer ${_.token}`}})).status===201?(J.show({title:"Registro exitoso",message:"Su solicitud ha sido recibida y está pendiente de aprobación.",color:"green",icon:r.jsx(q,{size:16})}),z(!0)):s("Hubo un problema al procesar su solicitud.")}catch(o){console.error("Registration error:",o),F.isAxiosError(o)&&o.response?s(o.response.data.error||"Error en el servidor. Intente de nuevo más tarde."):s("Error de conexión. Verifique su conexión a internet e intente de nuevo.")}finally{x(!1)}};return A?r.jsx(v,{size:"md",my:40,children:r.jsx(E,{radius:"md",p:"xl",withBorder:!0,children:r.jsxs(n,{align:"center",gap:"lg",children:[r.jsx(q,{size:50,color:"green"}),r.jsx(I,{order:2,ta:"center",children:"¡Registro exitoso!"}),r.jsx(y,{ta:"center",children:'Su solicitud de registro como administrador ha sido recibida correctamente. El estado de su cuenta es actualmente "pendiente". Un administrador revisará su información y aprobará su cuenta pronto.'}),r.jsx(y,{ta:"center",children:"Una vez aprobada, recibirá un correo electrónico de confirmación y podrá iniciar sesión en el sistema."}),r.jsx(c,{component:$,to:"/login",mt:"lg",children:"Ir a la página de inicio de sesión"})]})})}):r.jsx(v,{size:"lg",my:40,children:r.jsxs(E,{radius:"md",p:"xl",withBorder:!0,children:[r.jsx(I,{order:2,ta:"center",mb:"lg",children:"Registro de Administrador de Propiedades"}),j&&r.jsx(R,{icon:r.jsx(Y,{size:16}),title:"Error",color:"red",mb:"md",children:j}),r.jsxs("form",{onSubmit:a.onSubmit(B),children:[r.jsxs(l,{active:i,onStepClick:f,mb:"xl",children:[r.jsx(l.Step,{label:"Información personal",description:"Datos personales",children:r.jsxs(n,{gap:"md",mt:"md",children:[r.jsx(t,{label:"Nombre completo",placeholder:"Juan Pérez",required:!0,...a.getInputProps("full_name")}),r.jsx(t,{label:"Teléfono",placeholder:"+57 300 123 4567",required:!0,...a.getInputProps("phone")}),r.jsx(t,{label:"NIT/Identificación fiscal",placeholder:"123456789",...a.getInputProps("nit")}),r.jsx(t,{label:"Email",placeholder:"correo@ejemplo.com",required:!0,...a.getInputProps("email")}),r.jsx(S,{label:"Contraseña",placeholder:"Su contraseña",required:!0,...a.getInputProps("password")}),r.jsx(S,{label:"Confirmar contraseña",placeholder:"Confirme su contraseña",required:!0,...a.getInputProps("confirm_password")})]})}),r.jsx(l.Step,{label:"Propiedad",description:"Datos de la propiedad",children:r.jsxs(n,{gap:"md",mt:"md",children:[r.jsx(t,{label:"Dirección",placeholder:"Calle 123",required:!0,...a.getInputProps("property_address")}),r.jsx(t,{label:"Apartamento/Unidad",placeholder:"Apto 123",...a.getInputProps("property_apt_number")}),r.jsxs(p,{grow:!0,children:[r.jsx(t,{label:"Ciudad",placeholder:"Bogotá",required:!0,...a.getInputProps("property_city")}),r.jsx(t,{label:"Estado/Provincia",placeholder:"Cundinamarca",required:!0,...a.getInputProps("property_state")})]}),r.jsx(t,{label:"Código postal",placeholder:"110111",...a.getInputProps("property_zip_code")}),r.jsx(P,{label:"Tipo de propiedad",placeholder:"Seleccione el tipo de propiedad",data:W,required:!0,...a.getInputProps("property_type")})]})}),r.jsx(l.Step,{label:"Cuenta bancaria",description:"Información bancaria",children:r.jsxs(n,{gap:"md",mt:"md",children:[r.jsx(t,{label:"Nombre del banco",placeholder:"Banco Nacional",required:!0,...a.getInputProps("bank_name")}),r.jsx(P,{label:"Tipo de cuenta",placeholder:"Seleccione el tipo de cuenta",data:X,required:!0,...a.getInputProps("account_type")}),r.jsx(t,{label:"Número de cuenta",placeholder:"12345678901234",required:!0,...a.getInputProps("account_number")}),r.jsx(t,{label:"Titular de la cuenta",placeholder:"Juan Pérez",required:!0,...a.getInputProps("account_holder")})]})}),r.jsx(l.Step,{label:"Precios",description:"Información de precios",children:r.jsxs(n,{gap:"md",mt:"md",children:[r.jsxs(p,{grow:!0,children:[r.jsx(u,{label:"Renta mensual",placeholder:"0.00",required:!0,min:0,withAsterisk:!0,hideControls:!0,...a.getInputProps("monthly_rent")}),r.jsx(u,{label:"Depósito de seguridad",placeholder:"0.00",min:0,hideControls:!0,...a.getInputProps("security_deposit")})]}),r.jsx(u,{label:"Cargo por pago tardío",placeholder:"0.00",min:0,hideControls:!0,...a.getInputProps("late_fee")}),r.jsx(u,{label:"Día de vencimiento del pago",placeholder:"1",min:1,max:31,required:!0,...a.getInputProps("due_day")}),r.jsx(w,{label:"Servicios incluidos",placeholder:"Seleccione los servicios incluidos en la renta",data:k,...a.getInputProps("utilities_included")}),r.jsx(w,{label:"Servicios a cargo del inquilino",placeholder:"Seleccione los servicios a cargo del inquilino",data:k,...a.getInputProps("tenant_responsible_for")})]})}),r.jsx(l.Step,{label:"Condiciones",description:"Términos del contrato",children:r.jsxs(n,{gap:"md",mt:"md",children:[r.jsxs(p,{grow:!0,children:[r.jsx(C,{label:"Fecha de inicio",placeholder:"Seleccione una fecha",value:a.values.start_date,onChange:e=>a.setFieldValue("start_date",e||new Date)}),r.jsx(C,{label:"Fecha de fin",placeholder:"Seleccione una fecha",value:a.values.end_date,onChange:e=>a.setFieldValue("end_date",e||new Date)})]}),r.jsx(V,{label:"Términos de pago",placeholder:"Especifique los términos de pago",...a.getInputProps("payment_terms")}),r.jsxs(O,{mt:"xl",children:[r.jsx(U,{my:"md"}),r.jsx(y,{size:"sm",color:"dimmed",ta:"center",mb:"md",children:"Al enviar este formulario, usted confirma que toda la información proporcionada es verdadera y correcta. Su solicitud será revisada por un administrador y recibirá una notificación cuando su cuenta sea activada."})]})]})})]}),r.jsxs(p,{justify:"apart",mt:"xl",children:[r.jsx(c,{variant:"default",onClick:L,disabled:i===0,children:"Atrás"}),i===4?r.jsx(c,{type:"submit",disabled:g,children:g?r.jsx(G,{size:"sm"}):"Enviar solicitud"}):r.jsx(c,{onClick:D,children:"Siguiente"})]})]})]})})}export{ae as default};
